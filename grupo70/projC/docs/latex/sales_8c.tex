\hypertarget{sales_8c}{}\doxysection{Referência ao ficheiro sales.\+c}
\label{sales_8c}\index{sales.c@{sales.c}}


Ficheiro que contém as funções relativas ao carregamento das vendas.  


{\ttfamily \#include \char`\"{}sales.\+h\char`\"{}}\newline
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{sales_8c_a217878fa84ef5b04d2455a05f58cf8fc}\label{sales_8c_a217878fa84ef5b04d2455a05f58cf8fc}} 
\#define {\bfseries S\+M\+AX}~10
\item 
\mbox{\Hypertarget{sales_8c_a392fb874e547e582e9c66a08a1f23326}\label{sales_8c_a392fb874e547e582e9c66a08a1f23326}} 
\#define {\bfseries M\+AX}~64
\item 
\mbox{\Hypertarget{sales_8c_a70ed59adcb4159ac551058053e649640}\label{sales_8c_a70ed59adcb4159ac551058053e649640}} 
\#define {\bfseries S\+I\+ZE}~26
\end{DoxyCompactItemize}
\doxysubsection*{Funções}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{sales_8c_acebfdab38d03058af5bfe9ab145f43eb}{venda\+Val}} (int posp, int posc, float preco, int uni, char type, int mes, int branch)
\begin{DoxyCompactList}\small\item\em Função verifica se a venda é válida. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{sales_8c_a1aa08e74fd7bd182f45714772227fdd5}{saleS}} (\mbox{\hyperlink{structcatalogo}{Catalogo}} $\ast$tprod, \mbox{\hyperlink{structcatalogo}{Catalogo}} $\ast$tcli, \mbox{\hyperlink{structthashfact}{T\+Hash\+Fact}} $\ast$\mbox{\hyperlink{structfact}{fact}}, \mbox{\hyperlink{structgfiliais}{G\+Filiais}} $\ast$gfil, char $\ast$buffer, int $\ast$val, int $\ast$lida)
\begin{DoxyCompactList}\small\item\em Função separa uma venda em tokens e adiciona-\/os à estrutura de Faturação e Gestão de Filiais. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{sales_8c_a48b457392109e50f8a9bf91aa7c3d2c1}{load\+From\+Sales}} (\mbox{\hyperlink{structcatalogo}{Catalogo}} $\ast$tprod, \mbox{\hyperlink{structcatalogo}{Catalogo}} $\ast$tcli, \mbox{\hyperlink{structthashfact}{T\+Hash\+Fact}} $\ast$\mbox{\hyperlink{structfact}{fact}}, \mbox{\hyperlink{structgfiliais}{G\+Filiais}} $\ast$gfil, char $\ast$file\+Path, int $\ast$val, int $\ast$lida)
\begin{DoxyCompactList}\small\item\em Função le um ficheiro, valida e adiciona as vendas a T\+Hash\+Fact e G\+Filiais. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Descrição detalhada}
Ficheiro que contém as funções relativas ao carregamento das vendas. 



\doxysubsection{Documentação das funções}
\mbox{\Hypertarget{sales_8c_a48b457392109e50f8a9bf91aa7c3d2c1}\label{sales_8c_a48b457392109e50f8a9bf91aa7c3d2c1}} 
\index{sales.c@{sales.c}!loadFromSales@{loadFromSales}}
\index{loadFromSales@{loadFromSales}!sales.c@{sales.c}}
\doxysubsubsection{\texorpdfstring{loadFromSales()}{loadFromSales()}}
{\footnotesize\ttfamily int load\+From\+Sales (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structcatalogo}{Catalogo}} $\ast$}]{tprod,  }\item[{\mbox{\hyperlink{structcatalogo}{Catalogo}} $\ast$}]{tcli,  }\item[{\mbox{\hyperlink{structthashfact}{T\+Hash\+Fact}} $\ast$}]{fact,  }\item[{\mbox{\hyperlink{structgfiliais}{G\+Filiais}} $\ast$}]{gfil,  }\item[{char $\ast$}]{file\+Path,  }\item[{int $\ast$}]{val,  }\item[{int $\ast$}]{lida }\end{DoxyParamCaption})}



Função le um ficheiro, valida e adiciona as vendas a T\+Hash\+Fact e G\+Filiais. 


\begin{DoxyParams}{Parâmetros}
{\em tprod} & Apontador para Catalogo de Produtos \\
\hline
{\em tcli} & Apontador para Catalogo de Clientes \\
\hline
{\em fact} & Apontador para T\+Hash\+Fact \\
\hline
{\em gfil} & Apontador para G\+Filiais \\
\hline
{\em file\+Path} & Caminho para o ficheiro \\
\hline
{\em val} & Apontador para inteiro que contem o numero de vendas validadas \\
\hline
{\em lida} & Apontador para inteiro que contem o numero de vendas lidas \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Retorna}
Inteiro usado com Booleano 
\end{DoxyReturn}


Definido na linha 105 do ficheiro sales.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{105                                                                                                                          \{}
\DoxyCodeLine{106   FILE *fsales;}
\DoxyCodeLine{107   \textcolor{keywordtype}{char}* buffer= malloc(\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{char}) * MAX);}
\DoxyCodeLine{108 }
\DoxyCodeLine{109   \textcolor{keywordflow}{if}((fsales = fopen(filePath, \textcolor{stringliteral}{"r"})) == NULL) \{}
\DoxyCodeLine{110     perror(filePath);}
\DoxyCodeLine{111     \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{112   \}}
\DoxyCodeLine{113 }
\DoxyCodeLine{114   \textcolor{keywordflow}{while}(fgets(buffer,MAX,fsales)) \{}
\DoxyCodeLine{115     buffer = strsep(\&buffer, \textcolor{stringliteral}{"\(\backslash\)r"});}
\DoxyCodeLine{116     \mbox{\hyperlink{sales_8c_a1aa08e74fd7bd182f45714772227fdd5}{saleS}}(tprod, tcli, \mbox{\hyperlink{structfact}{fact}}, gfil, buffer, val, lida);}
\DoxyCodeLine{117   \}}
\DoxyCodeLine{118   \mbox{\hyperlink{filial_8c_a6a88f739991af768d56f35f7ffebb6b5}{remRepC}}(gfil);}
\DoxyCodeLine{119   \mbox{\hyperlink{filial_8c_a2ff937369b72804e8718df7f93a8117f}{remRepP}}(gfil);}
\DoxyCodeLine{120 }
\DoxyCodeLine{121   fclose(fsales);}
\DoxyCodeLine{122 }
\DoxyCodeLine{123   free(buffer);}
\DoxyCodeLine{124   buffer = NULL;}
\DoxyCodeLine{125 }
\DoxyCodeLine{126   \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{127 \}}

\end{DoxyCode}
\mbox{\Hypertarget{sales_8c_a1aa08e74fd7bd182f45714772227fdd5}\label{sales_8c_a1aa08e74fd7bd182f45714772227fdd5}} 
\index{sales.c@{sales.c}!saleS@{saleS}}
\index{saleS@{saleS}!sales.c@{sales.c}}
\doxysubsubsection{\texorpdfstring{saleS()}{saleS()}}
{\footnotesize\ttfamily void saleS (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structcatalogo}{Catalogo}} $\ast$}]{tprod,  }\item[{\mbox{\hyperlink{structcatalogo}{Catalogo}} $\ast$}]{tcli,  }\item[{\mbox{\hyperlink{structthashfact}{T\+Hash\+Fact}} $\ast$}]{fact,  }\item[{\mbox{\hyperlink{structgfiliais}{G\+Filiais}} $\ast$}]{gfil,  }\item[{char $\ast$}]{buffer,  }\item[{int $\ast$}]{val,  }\item[{int $\ast$}]{lida }\end{DoxyParamCaption})}



Função separa uma venda em tokens e adiciona-\/os à estrutura de Faturação e Gestão de Filiais. 


\begin{DoxyParams}{Parâmetros}
{\em tprod} & Apontador para Catalogo de Produtos \\
\hline
{\em tcli} & Apontador para Catalogo de Clientes \\
\hline
{\em fact} & Apontador para T\+Hash\+Fact \\
\hline
{\em gfil} & Apontador para G\+Filiais \\
\hline
{\em buffer} & String com a venda \\
\hline
{\em val} & Apontador para inteiro que contem o numero de vendas validadas \\
\hline
{\em lida} & Apontador para inteiro que contem o numero de vendas lidas \\
\hline
\end{DoxyParams}


Definido na linha 47 do ficheiro sales.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{47                                                                                                                 \{}
\DoxyCodeLine{48   \textcolor{keywordtype}{char} *aux = NULL, *prod = NULL, *cli = NULL, *type = NULL;}
\DoxyCodeLine{49   \textcolor{keywordtype}{int} hashp, hashc, posp=0, posc=0;}
\DoxyCodeLine{50   \textcolor{keywordtype}{int} uni, month, branch;}
\DoxyCodeLine{51   \textcolor{keywordtype}{float} price;}
\DoxyCodeLine{52 }
\DoxyCodeLine{53   aux = strsep(\&buffer, \textcolor{stringliteral}{" "});}
\DoxyCodeLine{54   prod = aux;}
\DoxyCodeLine{55 }
\DoxyCodeLine{56   aux = strsep(\&buffer, \textcolor{stringliteral}{" "});}
\DoxyCodeLine{57   price = atof(aux);}
\DoxyCodeLine{58 }
\DoxyCodeLine{59   aux = strsep(\&buffer, \textcolor{stringliteral}{" "});}
\DoxyCodeLine{60   uni = atoi(aux);}
\DoxyCodeLine{61 }
\DoxyCodeLine{62   aux = strsep(\&buffer, \textcolor{stringliteral}{" "});}
\DoxyCodeLine{63   type = aux;}
\DoxyCodeLine{64 }
\DoxyCodeLine{65   aux = strsep(\&buffer, \textcolor{stringliteral}{" "});}
\DoxyCodeLine{66   cli = aux;}
\DoxyCodeLine{67 }
\DoxyCodeLine{68   aux = strsep(\&buffer, \textcolor{stringliteral}{" "});}
\DoxyCodeLine{69   month = atoi(aux);}
\DoxyCodeLine{70 }
\DoxyCodeLine{71   aux = strsep(\&buffer, \textcolor{stringliteral}{" "});}
\DoxyCodeLine{72   branch = atoi(aux);}
\DoxyCodeLine{73 }
\DoxyCodeLine{74   hashc = \mbox{\hyperlink{catalogo_8c_a65df18a97df6196f2cd6778d71e2d49b}{hashCat}}(cli[0]);}
\DoxyCodeLine{75   hashp = \mbox{\hyperlink{catalogo_8c_a65df18a97df6196f2cd6778d71e2d49b}{hashCat}}(prod[0]);}
\DoxyCodeLine{76 }
\DoxyCodeLine{77   posc = \mbox{\hyperlink{catalogo_8c_a90eb6bfc54c9e1e1df6d142447af770b}{searchCat}}(cli, tcli);}
\DoxyCodeLine{78 }
\DoxyCodeLine{79   \textcolor{keywordflow}{if}(posc != (-\/1))}
\DoxyCodeLine{80     posp = \mbox{\hyperlink{catalogo_8c_a90eb6bfc54c9e1e1df6d142447af770b}{searchCat}}(prod, tprod);}
\DoxyCodeLine{81 }
\DoxyCodeLine{82   \textcolor{keywordflow}{if}(\mbox{\hyperlink{sales_8c_acebfdab38d03058af5bfe9ab145f43eb}{vendaVal}}(posp,posc,price,uni,type[0],month,branch)) \{}
\DoxyCodeLine{83     \mbox{\hyperlink{faturacao_8c_ae4c78193b51013941b9d6df86f45cc8b}{addFact}}(\mbox{\hyperlink{structfact}{fact}}, hashp, posp, month, branch, type[0], price, uni);}
\DoxyCodeLine{84     \mbox{\hyperlink{filial_8c_ab45a498df8ff02b14a82eefce4cea499}{addGFilP}}(gfil, hashp, posp, cli, branch, type[0]);}
\DoxyCodeLine{85     \mbox{\hyperlink{filial_8c_a39092528a8f78b4490d9a98d8383461a}{addGFilC}}(gfil, hashc, posc, prod, branch, month, price, uni);}
\DoxyCodeLine{86 }
\DoxyCodeLine{87     (*val)++;}
\DoxyCodeLine{88   \}}
\DoxyCodeLine{89 }
\DoxyCodeLine{90   (*lida)++;}
\DoxyCodeLine{91 \}}

\end{DoxyCode}
\mbox{\Hypertarget{sales_8c_acebfdab38d03058af5bfe9ab145f43eb}\label{sales_8c_acebfdab38d03058af5bfe9ab145f43eb}} 
\index{sales.c@{sales.c}!vendaVal@{vendaVal}}
\index{vendaVal@{vendaVal}!sales.c@{sales.c}}
\doxysubsubsection{\texorpdfstring{vendaVal()}{vendaVal()}}
{\footnotesize\ttfamily int venda\+Val (\begin{DoxyParamCaption}\item[{int}]{posp,  }\item[{int}]{posc,  }\item[{float}]{preco,  }\item[{int}]{uni,  }\item[{char}]{type,  }\item[{int}]{mes,  }\item[{int}]{branch }\end{DoxyParamCaption})}



Função verifica se a venda é válida. 


\begin{DoxyParams}{Parâmetros}
{\em posp} & Inteiro com o resultado da procura de um produto \\
\hline
{\em posc} & Inteiro com o resultado da procura de um cliente \\
\hline
{\em preco} & Float com o preço do produto \\
\hline
{\em type} & Char com o tipo de compra \\
\hline
{\em mes} & Inteiro com o mes da compra \\
\hline
{\em branch} & Inteiro com a filial da compra \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Retorna}
Inteiro usado como booleano 
\end{DoxyReturn}


Definido na linha 23 do ficheiro sales.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{23                                                                                        \{}
\DoxyCodeLine{24   \textcolor{keywordtype}{int} r;}
\DoxyCodeLine{25 }
\DoxyCodeLine{26   \textcolor{keywordflow}{if}(posp!=(-\/1) \&\& posc!=(-\/1) \&\& preco >= 0.0 \&\& preco < 1000.0}
\DoxyCodeLine{27     \&\& uni > 0 \&\& uni <= 200 \&\& (type == \textcolor{charliteral}{'N'} || type == \textcolor{charliteral}{'P'})}
\DoxyCodeLine{28     \&\& mes > 0 \&\& mes <= 12 \&\& branch > 0 \&\& branch <= 3)}
\DoxyCodeLine{29     r = 1;}
\DoxyCodeLine{30   \textcolor{keywordflow}{else}}
\DoxyCodeLine{31     r = 0;}
\DoxyCodeLine{32 }
\DoxyCodeLine{33   \textcolor{keywordflow}{return} r;}
\DoxyCodeLine{34 \}}

\end{DoxyCode}
